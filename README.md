
# URL Shortening Service
![Java](https://img.shields.io/badge/Java-ED8B00?style=for-the-badge&logo=java&logoColor=white)
![Spring](https://img.shields.io/badge/Spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white)
![Maven](https://img.shields.io/badge/Maven-C71A36?style=for-the-badge&logo=apache-maven&logoColor=white)

URL Shortening Service — это REST API приложение для сокращения длинных URL-адресов. Сервис предоставляет возможность преобразовать длинный URL в короткий, получить статистику по каждому сокращенному URL и отслеживать количество переходов.

## Функциональные возможности

- **Создание короткой ссылки**: позволяет создавать короткие URL-адреса из длинных.
- **Перенаправление по короткой ссылке**: переход по короткой ссылке перенаправляет на оригинальный URL.
- **Статистика ссылок**: доступ к статистике по каждой ссылке, включая количество переходов и рейтинг.
- **Периодическое обновление рейтинга**: сервис автоматически обновляет рейтинг ссылок в зависимости от их популярности.

## Технологии

- **Java 17**
- **Spring Boot 3.3.4**
- **Spring Data JPA**
- **H2 Database** (встроенная база данных для хранения ссылок)
- **Lombok** (для упрощения кода)

## Установка и запуск

### Предварительные требования

- Java 17 и выше
- Maven 3.6 и выше

### Шаги установки

1. Клонируйте репозиторий:

   ```bash
   git clone https://github.com/knapp900/URL-Shortening-Service.git
   cd URL-shortening
   ```

2. Соберите проект с помощью Maven:

   ```bash
   mvn clean install
   ```

3. Запустите приложение:

   ```bash
   mvn spring-boot:run
   ```

4. Откройте [H2 Console](http://localhost:8080/h2-console) для доступа к базе данных и отладки.

   - **JDBC URL**: `jdbc:h2:mem:url_shortener`
   - **Имя пользователя**: `h2`
   - **Пароль**: `password`

## Конфигурация

Файл `application.properties` содержит основные параметры конфигурации:

- **task.scheduling.interval**: интервал в миллисекундах для периодического обновления рейтинга ссылок (по умолчанию 60000 мс или 1 минута).
- **task.sql.interval**: интервал для SQL-запроса, определяющий период обновления рейтинга (в минутах).

## API Документация

### Создание короткой ссылки

- **URL**: `/`
- **Метод**: `POST`
- **Описание**: принимает оригинальный URL и возвращает сокращенную ссылку.
- **Тело запроса**:

  ```json
  {
      "original": "https://example.com"
  }
  ```

- **Ответ**:

  ```json
  {
      "original": "https://example.com",
      "link": "/abc12345"
  }
  ```

### Перенаправление по короткой ссылке

- **URL**: `/{shortURL}`
- **Метод**: `GET`
- **Описание**: перенаправляет пользователя на оригинальный URL.
  
### Получение статистики по всем ссылкам

- **URL**: `/stat?page=0&size=10`
- **Метод**: `GET`
- **Описание**: возвращает список всех ссылок с их статистикой.
  
### Получение статистики по конкретной ссылке

- **URL**: `/stat/{shortURL}`
- **Метод**: `GET`
- **Описание**: возвращает статистику для конкретного `shortURL`.
- **Пример ответа**:

  ```json
  {
      "link": "abc12345",
      "original": "https://example.com",
      "count": "5",
      "rank": "1.123"
  }
  ```

## Периодическое обновление рейтинга ссылок

Рейтинг ссылок обновляется автоматически каждые `task.scheduling.interval` миллисекунд, в зависимости от количества переходов на ссылку (используется логарифмическая формула).

## Производительность (Benchmark)

Для оценки производительности сервиса был проведён тест с использованием Apache Benchmark (AB). Ниже приведены результаты при 10,000 запросах с 50 одновременными соединениями.

Команда, использованная для тестирования:
```bash
ab -n 10000 -c 50 -p data.json -T application/json http://localhost:8080/
```

### Результаты

- **Общее количество запросов**: 10,000
- **Количество неудачных запросов**: 0
- **Время, затраченное на тесты**: 6.348 секунд
- **Запросов в секунду**: 1,575.27 [#/сек] (среднее)
- **Среднее время на запрос**: 31.741 мс
- **Среднее время на запрос (с учётом всех одновременных запросов)**: 0.635 мс
- **Скорость передачи**: 267.67 Kbytes/sec (приём), 286.13 kb/s (отправка), 553.81 kb/s (общая)

### Время подключения и обработки (мс)

| Минимум | Среднее | Среднеквадратичное отклонение | Медиана | Максимум |
|---------|---------|-------------------------------|---------|----------|
| Connect:      0 |    0   |   0.5  |    0    |     8   |
| Processing:   2 |   30   |  25.4  |   21    |   226   |
| Waiting:      1 |   29   |  25.2  |   20    |   224   |
| Total:        2 |   31   |  25.3  |   22    |   226   |

### Распределение времени обработки

| Процентиль | Время (мс) |
|------------|------------|
| 50%        | 22         |
| 66%        | 35         |
| 75%        | 43         |
| 80%        | 49         |
| 90%        | 66         |
| 95%        | 83         |
| 98%        | 99         |
| 99%        | 112        |
| 100%       | 226        |


## Контакты

- **Email: knapp900@gmail.com**
- **LinkedIn: [Arthur Knapp](#https://www.linkedin.com/in/arthur-knapp-808a6a166/)**
- **GitHub: [Knapp900](#https://github.com/knapp900)**

